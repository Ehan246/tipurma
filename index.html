<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ItemSalesBD | Shop</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Firebase v8 -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<style>
body {
    background:#0a0a0a;
    color:#00ff88;
    font-family:Arial, sans-serif;
    padding:20px;
}
.product {
    border:1px solid #00ff88;
    padding:15px;
    margin:15px 0;
}
button {
    background:#00ff88;
    border:none;
    padding:8px 15px;
    cursor:pointer;
}
</style>
</head>

<body>

<h1>ItemSalesBD</h1>
<div id="products">Loading products...</div>

<script>
/* Firebase Config */
const firebaseConfig = {
  apiKey: "AIzaSyDTyjzVYkwyeayKjZjfFNWHpLZJB5XOo1A",
  authDomain: "itemsalesbd.firebaseapp.com",
  databaseURL: "https://itemsalesbd-default-rtdb.firebaseio.com",
  projectId: "itemsalesbd",
  storageBucket: "itemsalesbd.firebasestorage.app",
  messagingSenderId: "390468845332",
  appId: "1:390468845332:web:7350cfdf25f23151688c01"
};
firebase.initializeApp(firebaseConfig);

const auth = firebase.auth();
const db = firebase.database();

/* Auto anonymous login */
auth.signInAnonymously();

/* Load products */
function loadProducts() {
    const box = document.getElementById('products');
    db.ref('products').once('value').then(snap => {
        if (!snap.exists()) {
            box.innerHTML = 'No products';
            return;
        }
        let html = '';
        snap.forEach(p => {
            const d = p.val();
            html += `
            <div class="product">
                <h3>${d.name}</h3>
                <p>Price: $${d.price}</p>
                <button onclick="buy('${p.key}')">Buy</button>
            </div>`;
        });
        box.innerHTML = html;
    });
}

/* Buy */
function buy(id) {
    const user = auth.currentUser;
    db.ref('products/' + id).once('value').then(snap => {
        const p = snap.val();
        db.ref('orders').push({
            productId: id,
            productName: p.name,
            price: p.price,
            userId: user.uid,
            status: 'pending',
            createdAt: Date.now()
        });
        alert('Order placed');
    });
}

loadProducts();
</script>

</body>
</html>
